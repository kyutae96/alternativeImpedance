# Alternative Impedance

<p align="center">
  <img src="assets/icons/app_icon.png" alt="App Icon" width="120" height="120">
</p>

<p align="center">
  <strong>ì¸ê³µ ì™€ìš°(Cochlear Implant) ì „ê·¹ ì„í”¼ë˜ìŠ¤ ì¸¡ì • ë° ì§„ë‹¨ ì•±</strong>
</p>

<p align="center">
  <a href="#ì£¼ìš”-ê¸°ëŠ¥">ì£¼ìš” ê¸°ëŠ¥</a> â€¢
  <a href="#ìŠ¤í¬ë¦°ìƒ·">ìŠ¤í¬ë¦°ìƒ·</a> â€¢
  <a href="#ì„¤ì¹˜-ë°©ë²•">ì„¤ì¹˜ ë°©ë²•</a> â€¢
  <a href="#ì‚¬ìš©-ë°©ë²•">ì‚¬ìš© ë°©ë²•</a> â€¢
  <a href="#ê¸°ìˆ -ìŠ¤íƒ">ê¸°ìˆ  ìŠ¤íƒ</a>
</p>

---

## ğŸ“‹ ê°œìš”

**Alternative Impedance**ëŠ” ì¸ê³µ ì™€ìš°(Cochlear Implant) ì¥ì¹˜ì˜ ì „ê·¹ ì„í”¼ë˜ìŠ¤ë¥¼ BLE(Bluetooth Low Energy)ë¥¼ í†µí•´ ì¸¡ì •í•˜ê³ , ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì „ê·¹ ìƒíƒœë¥¼ ì§„ë‹¨í•˜ëŠ” Flutter ê¸°ë°˜ ëª¨ë°”ì¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.

### ì£¼ìš” ëª©ì 
- ğŸ”¬ **32ì±„ë„ ì „ê·¹ ì„í”¼ë˜ìŠ¤ ì‹¤ì‹œê°„ ì¸¡ì •**
- ğŸ“Š **ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ê¸°ë°˜ ì •í™•í•œ ì§„ë‹¨**
- ğŸ’¾ **Firebase í´ë¼ìš°ë“œ ë°ì´í„° ì €ì¥ ë° ê´€ë¦¬**
- ğŸ“ˆ **ì¸¡ì • ë°ì´í„° ì‹œê°í™” ë° ë¶„ì„**

---

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

### 1. ğŸ”— BLE ì—°ê²° ë° ì¸¡ì •
- Nordic UART Service (NUS) í”„ë¡œí† ì½œ ê¸°ë°˜ BLE í†µì‹ 
- ë‚´ë¶€ê¸° ID ìë™ ì¸ì‹
- 32ì±„ë„ (CH 1-16, CH 17-32) ë™ì‹œ ì¸¡ì •
- ì‹¤ì‹œê°„ ì¸¡ì • ë°ì´í„° ìˆ˜ì‹  ë° í‘œì‹œ

### 2. ğŸ“ ìº˜ë¦¬ë¸Œë ˆì´ì…˜
- **2í¬ì¸íŠ¸ ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì‹œìŠ¤í…œ**
  - Min í¬ì¸íŠ¸: ìµœì†Œ ì €í•­ê°’ ì„¤ì •
  - Max í¬ì¸íŠ¸: ìµœëŒ€ ì €í•­ê°’ ì„¤ì •
- **ê¸°ìš¸ê¸°(Slope) / ì ˆí¸(Intercept) ìë™ ê³„ì‚°**
  ```
  Slope = (R_Max - R_Min) / (Imp_Max - Imp_Min)
  Intercept = R_Min - (Slope Ã— Imp_Min)
  ```
- ì±„ë„ ê·¸ë£¹ë³„ ë…ë¦½ ìº˜ë¦¬ë¸Œë ˆì´ì…˜ (CH 1-16, CH 17-32)

### 3. ğŸ©º ì „ê·¹ ìƒíƒœ ì§„ë‹¨
| ìƒíƒœ | ì¡°ê±´ | ì˜ë¯¸ |
|------|------|------|
| âœ… **ì •ìƒ** | Min â‰¤ RawValue â‰¤ Max | ì „ê·¹ ì •ìƒ ì‘ë™ |
| ğŸ”µ **ì‡¼íŠ¸** | RawValue < Min | ì „ê·¹ ë‹¨ë½ (Short Circuit) |
| ğŸ”´ **ì˜¤í”ˆ** | RawValue > Max | ì „ê·¹ ê°œë°© (Open Circuit) |

### 4. â˜ï¸ í´ë¼ìš°ë“œ ë°ì´í„° ê´€ë¦¬
- **Firebase Firestore ì—°ë™**
- ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ë°ì´í„° ì €ì¥/ì¡°íšŒ
- ì¸¡ì • ê²°ê³¼ ì €ì¥/ì¡°íšŒ
- ë‚´ë¶€ê¸° ID ê¸°ë°˜ ë°ì´í„° ë§¤ì¹­
- ë‚ ì§œ/IDë³„ ì •ë ¬ ë° ê²€ìƒ‰

### 5. ğŸ“Š ë°ì´í„° ì‹œê°í™”
- ì±„ë„ë³„ ì„í”¼ë˜ìŠ¤ ê·¸ë˜í”„ (Line Chart)
- ì¸¡ì • ê²°ê³¼ ë§‰ëŒ€ ê·¸ë˜í”„ (Bar Chart)
- ìƒíƒœë³„ ìƒ‰ìƒ êµ¬ë¶„ (ì •ìƒ: ë…¹ìƒ‰, ì‡¼íŠ¸: íŒŒë‘, ì˜¤í”ˆ: ë¹¨ê°•)
- í„°ì¹˜ ì¸í„°ë™ì…˜ ì§€ì›

### 6. ğŸ“¤ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
- Excel (.xlsx) íŒŒì¼ ë‚´ë³´ë‚´ê¸°
- ê³µìœ  ê¸°ëŠ¥ ì§€ì›

---

## ğŸ“± í™”ë©´ êµ¬ì„±

### íƒ­ êµ¬ì¡°

| íƒ­ | ì„¤ëª… |
|-----|------|
| **ğŸ  í™ˆ** | ì•± ê°œìš” ë° BLE ì—°ê²° ìƒíƒœ |
| **ğŸ“ ì¸¡ì •** | BLE ì—°ê²°, ì„í”¼ë˜ìŠ¤ ì¸¡ì •, ìº˜ë¦¬ë¸Œë ˆì´ì…˜ |
| **ğŸ©º ì§„ë‹¨** | ì¸¡ì • ë°ì´í„° ì§„ë‹¨ ë° Firebase ì €ì¥ |
| **â˜ï¸ í´ë¼ìš°ë“œ** | ì €ì¥ëœ ë°ì´í„° ì¡°íšŒ ë° ìƒì„¸ ë¶„ì„ |
| **âš™ï¸ ì„¤ì •** | ì•± ì„¤ì • ë° Firebase ì»¬ë ‰ì…˜ ê´€ë¦¬ |

---

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ

### Framework & Language
- **Flutter** 3.35.4
- **Dart** 3.9.2

### ìƒíƒœ ê´€ë¦¬
- **Provider** 6.1.5+1

### Backend & Database
- **Firebase Core** 3.6.0
- **Cloud Firestore** 5.4.3

### BLE í†µì‹ 
- **flutter_blue_plus** 1.36.8

### ì°¨íŠ¸ & ì‹œê°í™”
- **fl_chart** 0.69.2

### ë°ì´í„° ì²˜ë¦¬
- **excel** 4.0.6
- **path_provider** 2.1.5
- **share_plus** 10.1.4
- **shared_preferences** 2.5.3

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
lib/
â”œâ”€â”€ main.dart                 # ì•± ì§„ì…ì 
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ ble_device.dart       # BLE ë””ë°”ì´ìŠ¤ ëª¨ë¸
â”‚   â””â”€â”€ impedance_data.dart   # ì„í”¼ë˜ìŠ¤ ë°ì´í„° ëª¨ë¸
â”œâ”€â”€ providers/
â”‚   â””â”€â”€ impedance_provider.dart # ìƒíƒœ ê´€ë¦¬ í”„ë¡œë°”ì´ë”
â”œâ”€â”€ screens/
â”‚   â”œâ”€â”€ home_screen.dart      # í™ˆ í™”ë©´
â”‚   â”œâ”€â”€ measurement_screen.dart # ì¸¡ì • í™”ë©´
â”‚   â”œâ”€â”€ new_impedance_screen.dart # ì§„ë‹¨ í™”ë©´
â”‚   â”œâ”€â”€ cloud_data_screen.dart # í´ë¼ìš°ë“œ ë°ì´í„° í™”ë©´
â”‚   â”œâ”€â”€ settings_screen.dart  # ì„¤ì • í™”ë©´
â”‚   â”œâ”€â”€ ble_scan_dialog.dart  # BLE ìŠ¤ìº” ë‹¤ì´ì–¼ë¡œê·¸
â”‚   â””â”€â”€ chart_analysis_screen.dart # ì°¨íŠ¸ ë¶„ì„ í™”ë©´
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ ble_service.dart      # BLE í†µì‹  ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ firebase_service.dart # Firebase ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ excel_service.dart    # Excel ë‚´ë³´ë‚´ê¸° ì„œë¹„ìŠ¤
â”‚   â””â”€â”€ cache_service.dart    # ìºì‹œ ì„œë¹„ìŠ¤
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ constants.dart        # ì•± ìƒìˆ˜ ì •ì˜
â”‚   â”œâ”€â”€ font_size_provider.dart # í°íŠ¸ í¬ê¸° ê´€ë¦¬
â”‚   â””â”€â”€ toast_manager.dart    # í† ìŠ¤íŠ¸ ë©”ì‹œì§€ ê´€ë¦¬
â””â”€â”€ widgets/
    â”œâ”€â”€ ble_status_card.dart  # BLE ìƒíƒœ ì¹´ë“œ
    â”œâ”€â”€ electrode_status_grid.dart # ì „ê·¹ ìƒíƒœ ê·¸ë¦¬ë“œ
    â”œâ”€â”€ impedance_chart.dart  # ì„í”¼ë˜ìŠ¤ ì°¨íŠ¸
    â””â”€â”€ measurement_params_card.dart # ì¸¡ì • íŒŒë¼ë¯¸í„° ì¹´ë“œ
```

---

## âš™ï¸ ì„¤ì¹˜ ë°©ë²•

### ì‚¬ì „ ìš”êµ¬ì‚¬í•­
- Flutter SDK 3.35.4 ì´ìƒ
- Dart SDK 3.9.2 ì´ìƒ
- Android Studio / VS Code
- Firebase í”„ë¡œì íŠ¸ ì„¤ì •

### ì„¤ì¹˜ ë‹¨ê³„

1. **ë ˆí¬ì§€í† ë¦¬ í´ë¡ **
   ```bash
   git clone https://github.com/kyutae96/alternativeImpedance.git
   cd alternativeImpedance
   ```

2. **ì˜ì¡´ì„± ì„¤ì¹˜**
   ```bash
   flutter pub get
   ```

3. **Firebase ì„¤ì •**
   - Firebase Consoleì—ì„œ í”„ë¡œì íŠ¸ ìƒì„±
   - `google-services.json`ì„ `android/app/` ë””ë ‰í† ë¦¬ì— ì¶”ê°€
   - Firestore Database ìƒì„±

4. **ì•± ì‹¤í–‰**
   ```bash
   flutter run
   ```

### APK ë¹Œë“œ
```bash
flutter build apk --release
```

---

## ğŸ“– ì‚¬ìš© ë°©ë²•

### 1. BLE ì—°ê²°
1. **ì¸¡ì •** íƒ­ìœ¼ë¡œ ì´ë™
2. **BLE ì—°ê²°** ë²„íŠ¼ í´ë¦­
3. ì£¼ë³€ ê¸°ê¸° ìŠ¤ìº” í›„ ëŒ€ìƒ ê¸°ê¸° ì„ íƒ
4. ì—°ê²° ì™„ë£Œ ì‹œ ë‚´ë¶€ê¸° ID ìë™ í‘œì‹œ

### 2. ìº˜ë¦¬ë¸Œë ˆì´ì…˜
1. **Min í¬ì¸íŠ¸ ì„ íƒ**
   - ìµœì†Œ ì €í•­ê°’ì—ì„œ ì„í”¼ë˜ìŠ¤ ì¸¡ì •
   - ê·¸ë˜í”„ì—ì„œ í¬ì¸íŠ¸ ì„ íƒ í›„ **Min ì„¤ì •**
2. **Max í¬ì¸íŠ¸ ì„ íƒ**
   - ìµœëŒ€ ì €í•­ê°’ì—ì„œ ì„í”¼ë˜ìŠ¤ ì¸¡ì •
   - ê·¸ë˜í”„ì—ì„œ í¬ì¸íŠ¸ ì„ íƒ í›„ **Max ì„¤ì •**
3. **ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì €ì¥**
   - ê³„ì‚°ëœ ê¸°ìš¸ê¸°/ì ˆí¸ í™•ì¸
   - Firebaseì— ì €ì¥

### 3. ì„í”¼ë˜ìŠ¤ ì¸¡ì • ë° ì§„ë‹¨
1. ì‹¤ì œ ì¸¡ì • ëŒ€ìƒì—ì„œ ì„í”¼ë˜ìŠ¤ ì¸¡ì •
2. **ì§„ë‹¨** íƒ­ì—ì„œ ê²°ê³¼ í™•ì¸
3. ì •ìƒ/ì‡¼íŠ¸/ì˜¤í”ˆ ìƒíƒœ ìë™ íŒì •
4. Firebaseì— ì¸¡ì • ê²°ê³¼ ì €ì¥

### 4. ë°ì´í„° ì¡°íšŒ
1. **í´ë¼ìš°ë“œ** íƒ­ì—ì„œ ì €ì¥ëœ ë°ì´í„° ì¡°íšŒ
2. ìº˜ë¦¬ë¸Œë ˆì´ì…˜/ì¸¡ì • ê²°ê³¼ ì„ íƒ
3. ìƒì„¸ ë³´ê¸°ì—ì„œ ê³„ì‚° ê³¼ì • í™•ì¸

---

## ğŸ“Š ì¸¡ì • íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ê¸°ë³¸ê°’ | ì„¤ëª… |
|----------|--------|------|
| Repeat Count | 10 | ì¸¡ì • ë°˜ë³µ íšŸìˆ˜ |
| Channel Selection | 255 | ì „ì²´ ì±„ë„ ì„ íƒ |
| Narrow Pulse Width | 15 Î¼s | ì¢ì€ í„ìŠ¤ í­ |
| Wide Pulse Width | 25 Î¼s | ë„“ì€ í„ìŠ¤ í­ |
| Stimulation Level | 280 | ìê·¹ ë ˆë²¨ |

---

## ğŸ”Œ BLE í”„ë¡œí† ì½œ

### Nordic UART Service (NUS) UUID
| íƒ€ì… | UUID |
|------|------|
| Service | `6e400001-b5a3-f393-e0a9-e50e24dcca9e` |
| TX Characteristic | `6e400002-b5a3-f393-e0a9-e50e24dcca9e` |
| RX Characteristic | `6e400003-b5a3-f393-e0a9-e50e24dcca9e` |

### Command Codes
| ëª…ë ¹ | ì½”ë“œ | ì„¤ëª… |
|------|------|------|
| Program Start | `0x60` | í”„ë¡œê·¸ë¨ ì‹œì‘ |
| Program End | `0x61` | í”„ë¡œê·¸ë¨ ì¢…ë£Œ |
| Impedance Measurement | `0x62` | ì„í”¼ë˜ìŠ¤ ì¸¡ì • |
| Inner Device ID | `0x91` | ë‚´ë¶€ê¸° ID ìš”ì²­ |

---

## ğŸ“ ì €í•­ê°’ ë§¤í•‘

ì±„ë„ë³„ ì €í•­ê°’ (CH 1-16, CH 17-32 ë™ì¼):

| ì±„ë„ | ì €í•­ê°’ (Î©) | ì±„ë„ | ì €í•­ê°’ (Î©) |
|------|-----------|------|-----------|
| 1 | 300 | 9 | 5000 |
| 2 | 500 | 10 | 6000 |
| 3 | 1000 | 11 | 7000 |
| 4 | 1500 | 12 | 8000 |
| 5 | 2000 | 13 | 9000 |
| 6 | 2500 | 14 | 10000 |
| 7 | 3000 | 15 | 12000 |
| 8 | 4000 | 16 | 15000 |

---

## ğŸ” Firebase ì»¬ë ‰ì…˜

### ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ë°ì´í„°
```
Collection: alternativeImpedanceParam
Document: {
  innerID: String,
  date: String,
  combin1At1to16Min: String,
  combin1At1to16Max: String,
  combin1At1to16Inclin: String,  // Slope
  combin1At1to16Cap: String,     // Intercept
  combin1At17to32Min: String,
  combin1At17to32Max: String,
  combin1At17to32Inclin: String,
  combin1At17to32Cap: String,
  ...
}
```

### ì¸¡ì • ê²°ê³¼ ë°ì´í„°
```
Collection: testNewImpedanceParam
Document: {
  innerID: String,
  date: String,
  measurements: Map<String, String>  // {"0": "1234", "1": "ì „ê·¹ ì‡¼íŠ¸ (5.2)", ...}
}
```

---

## ğŸ“ ë²„ì „ íˆìŠ¤í† ë¦¬

### v1.0.0 (2024-01-06)
- ì´ˆê¸° ë¦´ë¦¬ì¦ˆ
- BLE ì—°ê²° ë° 32ì±„ë„ ì„í”¼ë˜ìŠ¤ ì¸¡ì •
- 2í¬ì¸íŠ¸ ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì‹œìŠ¤í…œ
- ì „ê·¹ ìƒíƒœ ì§„ë‹¨ (ì •ìƒ/ì‡¼íŠ¸/ì˜¤í”ˆ)
- Firebase í´ë¼ìš°ë“œ ì—°ë™
- ë°ì´í„° ì‹œê°í™” ë° Excel ë‚´ë³´ë‚´ê¸°
- ê¸€ì í¬ê¸° ì¡°ì ˆ ê¸°ëŠ¥

---

## ğŸ¤ ê¸°ì—¬

ë²„ê·¸ ë¦¬í¬íŠ¸, ê¸°ëŠ¥ ì œì•ˆ, Pull Requestë¥¼ í™˜ì˜í•©ë‹ˆë‹¤!

---

## ğŸ“„ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” MIT ë¼ì´ì„ ìŠ¤ í•˜ì— ë°°í¬ë©ë‹ˆë‹¤.

---

## ğŸ“ ë¬¸ì˜

í”„ë¡œì íŠ¸ ê´€ë ¨ ë¬¸ì˜ì‚¬í•­ì€ Issuesë¥¼ í†µí•´ ë‚¨ê²¨ì£¼ì„¸ìš”.

---

<p align="center">
  Made with â¤ï¸ using Flutter
</p>
